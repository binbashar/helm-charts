#
# Project metadata
#
metadata:
  org: "binbash.com.ar/devops/"
  maintainer: "DevOps (devops@binbash.com.ar)"
  description: "Desired state file for Binbash DEVELOPMENT environment."


#
# Kubectl, Helm and Helmsman settings
#
settings:
  kubeContext: "kubernetes-admin@kind-helm"    # Will try connect to this context first, otherwise, it will be created
  storageBackend: "secret"                     # Use secret for storage, default is configMap
  tillerless: true                             # Run helm in tillerless mode


#
# Helm Repositories
#
helmRepos:
  stable: "https://kubernetes-charts.storage.googleapis.com"
  incubator: "http://storage.googleapis.com/kubernetes-charts-incubator"
  jetstack: "https://charts.jetstack.io"
  linkerd: "https://helm.linkerd.io/stable"


#
# Define below the namespaces that will be used by the charts
#
namespaces:
  kube-system:
    installTiller: false

  monitoring:
    protected: false        # Protect this from deletion?
    installTiller: false    # Do not install Tiller on the cluster
    labels:                 # Add useful labels to this namespace
      env: "local-test"

  linkerd:
    protected: true
    installTiller: false
    labels:
      env: "local-test"

  nginx-ingress:
    installTiller: false
    labels:
      env: "local-test"

  cert-manager:
    installTiller: false
    labels:
      env: "local-test"

  fluentd:
    installTiller: false
    labels:
      env: "local-test"
      
  tracing:
    installTiller: false
    labels:
      env: "local-test"
      
  utilities:
    installTiller: false
    labels:
      env: "local-test"


#
# Define below the charts that will be deployed on this environment
#
apps:
  kube-job-cleaner:
    namespace: utilities                         # Maps to the namespace defined in the namespaces section above
    enabled: true                                # Set to false if you want to delete this app release
    chart: ../../@local-charts/kube-job-cleaner/ # Local path to the chart; or chart name if you use one from a repository
    version: 0.1.0                               # Which version to deploy
    name: kube-job-cleaner                       # This should be unique across all apps
    description: kube-job-cleaner                # Just a nice description
    valuesFile: ./kube-job-cleaner/values.yaml   # Override default chart values
    purge: true                                  # Make helm purge this release when it is removed

  kubernetes-dashboard:
    namespace: kube-system
    enabled: true
    chart: stable/kubernetes-dashboard
    version: 1.10.1
    name: kubernetes-dashboard
    description: Kubernetes Dashboard
    valuesFile: "./kubernetes-dashboard/values.yaml"
    purge: true
    protected: false

  weave-scope:
    namespace: monitoring
    enabled: true
    chart: stable/weave-scope
    version: 1.1.6
    name: weave-scope
    description: Weave Scope is a visualization and monitoring tool for Docker and Kubernetes.
    valuesFile: "./weave-scope/values.yaml"
    purge: true
    protected: false

  kube-state-metrics:
    namespace: monitoring
    enabled: true
    chart: stable/kube-state-metrics
    version: 2.3.1
    name: kube-state-metrics
    description: Kubernetes State Metrics
    valuesFile: "./kube-state-metrics/values.yaml"
    purge: true
    protected: false

  node-exporter:
    namespace: monitoring
    enabled: true
    chart: stable/prometheus-node-exporter
    version: 1.6.0
    name: node-exporter
    description: Prometheus Node Exporter
    valuesFile: ./node-exporter/values.yaml
    purge: true

  linkerd2:
    namespace: linkerd
    enabled: false
    chart: linkerd/linkerd2
    version: 2.6.0
    name: linkerd2
    description: Linkerd2
    valuesFile: ./linkerd2/secrets.dec.yaml
    purge: true

  nginx-ingress:
    namespace: nginx-ingress
    enabled: true
    chart: stable/nginx-ingress
    version: 1.20.0
    name: nginx-ingress
    description: nginx-ingress with a node port service associated
    valuesFile: ./nginx-ingress/values.yaml
    purge: true

  fluentd:
    namespace: fluentd
    enabled: true
    chart: ../../@local-charts/fluentd-daemonset
    version: 0.1.0
    name: fluentd
    description: FluentD
    valuesFile: ./fluentd-daemonset/values.yaml
    purge: true

  jaeger:
    namespace: tracing
    enabled: true
    chart: ../../@local-charts/jaeger
    version: 0.1.0
    name: jaeger
    description: Jaeger Distributed Tracing
    valuesFile: ./jaeger/values.yaml
    purge: true

  opencensus:
    namespace: tracing
    enabled: true
    chart: ../../@local-charts/opencensus
    version: 0.1.0
    name: opencensus
    description: OpenCensus Collector
    valuesFile: ./opencensus/values.yaml
    purge: true

  onetimesecret:
    namespace: utilities
    enabled: true
    chart: ../../@local-charts/onetimesecret/
    version: 0.1.1
    name: onetimesecret
    description: OneTimeSecret
    valuesFiles:
      - ./onetimesecret/values.yaml
    purge: true